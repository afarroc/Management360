{% extends 'layouts/base.html' %}
{% load static %}

{% block content %}

<div class="pagetitle">
    <h1>{{ page_title }}</h1>
    <nav>
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'rooms:lobby' %}">Home</a></li>
            <li class="breadcrumb-item"><a href="{% url 'rooms:room_list' %}">Rooms</a></li>
            <li class="breadcrumb-item"><a href="{% url 'rooms:room_detail' room.pk %}">{{ room.name }}</a></li>
            <li class="breadcrumb-item active">Vista 3D</li>
        </ol>
    </nav>
</div>

<section class="section">
    <div class="row">
        <div class="col-lg-12">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h5 class="card-title">Renderizado 3D Isométrico</h5>
                        <div>
                            <a href="{% url 'rooms:room_detail' room.pk %}" class="btn btn-outline-primary">
                                <i class="bi bi-info-circle"></i> Vista Normal
                            </a>
                            <a href="{% url 'rooms:room_list' %}" class="btn btn-outline-secondary">
                                <i class="bi bi-list"></i> Todas las Habitaciones
                            </a>
                        </div>
                    </div>

                    <div class="text-center mb-4">
                        <div class="alert alert-info">
                            <i class="bi bi-info-circle"></i>
                            <strong>Perspectiva Isométrica (Caballero):</strong>
                            Esta vista muestra la habitación con proporciones 3D reales usando proyección isométrica.
                            Los ejes X e Y están inclinados 30° del horizontal, mientras que Z permanece vertical.
                        </div>
                    </div>

                    <div class="d-flex justify-content-center">
                        <div class="border rounded p-3 bg-white" style="max-width: 900px;">
                            {% autoescape off %}
                            {{ svg_content }}
                            {% endautoescape %}
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="card-title mb-0">Propiedades de la Habitación</h6>
                                </div>
                                <div class="card-body">
                                    <table class="table table-sm">
                                        <tr>
                                            <td><strong>Nombre:</strong></td>
                                            <td>{{ room.name }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Tipo:</strong></td>
                                            <td>{{ room.get_room_type_display }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Dimensiones:</strong></td>
                                            <td>{{ room.length }} × {{ room.width }} × {{ room.height }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Posición:</strong></td>
                                            <td>({{ room.x }}, {{ room.y }}, {{ room.z }})</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Rotación:</strong></td>
                                            <td>Yaw: {{ room.yaw }}°, Pitch: {{ room.pitch }}°, Roll: {{ room.roll }}°</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Material:</strong></td>
                                            <td>{{ room.get_material_type_display }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Colores:</strong></td>
                                            <td><span style="color: {{ room.color_primary }};">●</span> {{ room.color_primary }} / <span style="color: {{ room.color_secondary }};">●</span> {{ room.color_secondary }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Masa:</strong></td>
                                            <td>{{ room.mass }} kg</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Densidad:</strong></td>
                                            <td>{{ room.density }} g/cm³</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Temperatura:</strong></td>
                                            <td>{{ room.temperature }}°C</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Iluminación:</strong></td>
                                            <td>{{ room.lighting_intensity }}%</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Salud:</strong></td>
                                            <td>{{ room.health }}%</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Estado:</strong></td>
                                            <td>{% if room.is_active %}Activa{% else %}Inactiva{% endif %}</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="card-title mb-0">Información Técnica</h6>
                                </div>
                                <div class="card-body">
                                    <p class="mb-2">
                                        <strong>Proyección:</strong> Isométrica (30°)
                                    </p>
                                    <p class="mb-2">
                                        <strong>Formato:</strong> SVG Vectorial
                                    </p>
                                    <p class="mb-2">
                                        <strong>Escala:</strong> 1 unidad = 8 píxeles
                                    </p>
                                    <p class="mb-0">
                                        <strong>Caras visibles:</strong> 6 (ordenadas por profundidad)
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

{% endblock %}